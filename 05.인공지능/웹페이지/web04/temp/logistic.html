<div class="my-5">
    <h1 class="text-center mb-5">{{title}}</h1>
    <div class="row justify-content-center">
        <form class="col-12 col-md-6 mb-3" name="frm">
            <div class="input-group">
                <input placeholder="공부시간" class="form-control" name="hour">
                <button class="btn btn-info">합격예상</button>
                <!--from안의 btn은 submit-->
            </div>
        </form>
    </div>
    <div class="row justify-content-center">
        <div class="col-12 col-md-8 col-lg-6">  <!--폭-->
            <ul class="nav nav-tabs" id="myTab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home-tab-pane"
                        type="button" role="tab" aria-controls="home-tab-pane" aria-selected="true">그래프출력</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile-tab-pane"
                        type="button" role="tab" aria-controls="profile-tab-pane" aria-selected="false">예측결과</button>
                </li>
            </ul>
            <div class="tab-content p-3" id="myTabContent">
                <div class="tab-pane fade show active" id="home-tab-pane" role="tabpanel" aria-labelledby="home-tab"
                    tabindex="0">
                    <button class="btn btn-info w-100">그래프출력</button>
                    <img src='http://placehold.co/500x300' width="100%">
                </div>
                <div class="tab-pane fade" id="profile-tab-pane" role="tabpanel" aria-labelledby="profile-tab"
                    tabindex="0">
                    <button id="btn2" class="btn btn-info w-100 mb-2">예측결과</button>
                    <div id="result">{{table|safe}}</div>
            </div>
        </div>
    </div>
</div>
<script>
    $("#btn2").on('click', function(){
        $.ajax({
            type:'get',
            url: '/logistic/predict/data',
            success:function(data){
                $("#result").html(data)
            }
        })
    })


    $(frm).on("submit", function (e) {
        e.preventDefault();
        const hour = $(frm.hour).val();
        if (hour == '') {
            $("#box").modal('show');
            $("#box .modal-body").html('공부시간을 입력해주세요!');
            return;
        }
        $.ajax({
            type: 'get',
            url: '/logistic/predict',
            data: { hour },
            success: function (data) {
                //console.log(data)
                let str = '';
                if (data.result == 1) {
                    str = '<b>합격</b>이 예상됩니다.'
                }
                else {
                    str = '<b>불합격</b>이 예상됩니다.'
                }
                str += `<br>불합격률:${data.fail}, 합격률:${data.pass}`;
                $("#box").modal('show');
                $("#box .modal-body").html(str)
            }
        })
    });

    //유효성체크 - 문자입력금지
    // const inputElement = document.getElementsByName('hour')[0];
    // inputElement.addEventListener('input', function(event) {
    //     let value = event.target.value;
    //     value = value.replace(/[^0-9.]/g, '').replace(/(\.)(\.)+/g, '$1');
    //     event.target.value = value;
    // });

    $("[name='hour']").on("input", function () {
        let value = $(this).val();
        value = value.replace(/[^0-9.]/g, '');  // 숫자와 소수점만 허용
        value = value.replace(/(\..*?)\..*/g, '$1');  // 소수점이 여러 개 들어오면 첫 번째만 유지
        $(this).val(value);
    });

</script>